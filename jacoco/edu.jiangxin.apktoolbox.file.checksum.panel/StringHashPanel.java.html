<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StringHashPanel.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ApkToolBoxGUI</a> &gt; <a href="index.source.html" class="el_package">edu.jiangxin.apktoolbox.file.checksum.panel</a> &gt; <span class="el_source">StringHashPanel.java</span></div><h1>StringHashPanel.java</h1><pre class="source lang-java linenums">package edu.jiangxin.apktoolbox.file.checksum.panel;

import edu.jiangxin.apktoolbox.file.checksum.CalculateType;
import edu.jiangxin.apktoolbox.swing.extend.EasyChildTabbedPanel;
import edu.jiangxin.apktoolbox.utils.Constants;
import org.apache.commons.codec.digest.DigestUtils;

import javax.swing.*;
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.util.zip.CRC32;

<span class="nc" id="L14">public class StringHashPanel extends EasyChildTabbedPanel {</span>
    private static final long serialVersionUID = 63924900336217723L;

    private JPanel stringInputPanel;
    private JTextArea stringInputTextArea;

    private JPanel optionPanel;

    private JTextField stringLengthTextField;
    private JCheckBox md5CheckBox;
    private JTextField md5TextField;
    private JCheckBox sha1CheckBox;
    private JTextField sha1TextField;
    private JCheckBox sha256CheckBox;
    private JTextField sha256TextField;
    private JCheckBox sha384CheckBox;
    private JTextField sha384TextField;
    private JCheckBox sha512CheckBox;
    private JTextField sha512TextField;
    private JCheckBox crc32CheckBox;
    private JTextField crc32TextField;

    private JPanel operationPanel;
    private JProgressBar progressBar;

    @Override
    public void createUI() {
<span class="nc" id="L41">        BoxLayout boxLayout = new BoxLayout(this, BoxLayout.Y_AXIS);</span>
<span class="nc" id="L42">        setLayout(boxLayout);</span>

<span class="nc" id="L44">        add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L45">        createStringInputPanel();</span>
<span class="nc" id="L46">        add(stringInputPanel);</span>

<span class="nc" id="L48">        add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L49">        createOptionPanel();</span>
<span class="nc" id="L50">        add(optionPanel);</span>

<span class="nc" id="L52">        add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L53">        createOperationPanel();</span>
<span class="nc" id="L54">        add(operationPanel);</span>
<span class="nc" id="L55">    }</span>

    private void createStringInputPanel() {
<span class="nc" id="L58">        stringInputPanel = new JPanel();</span>
<span class="nc" id="L59">        BoxLayout boxLayout = new BoxLayout(stringInputPanel, BoxLayout.Y_AXIS);</span>
<span class="nc" id="L60">        stringInputPanel.setLayout(boxLayout);</span>

<span class="nc" id="L62">        JLabel stringInputLabel = new JLabel(&quot;Insert string to compute hash checksum:&quot;);</span>
<span class="nc" id="L63">        stringInputTextArea = new JTextArea(5, 4);</span>
<span class="nc" id="L64">        stringInputTextArea.setLineWrap(true);</span>
<span class="nc" id="L65">        JScrollPane stringInputScrollPanel = new JScrollPane(stringInputTextArea);</span>

<span class="nc" id="L67">        stringInputPanel.add(stringInputLabel);</span>
<span class="nc" id="L68">        stringInputPanel.add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L69">        stringInputPanel.add(stringInputScrollPanel);</span>
<span class="nc" id="L70">    }</span>

    private void createOptionPanel() {
<span class="nc" id="L73">        optionPanel = new JPanel();</span>
<span class="nc" id="L74">        BoxLayout boxLayout = new BoxLayout(optionPanel, BoxLayout.Y_AXIS);</span>
<span class="nc" id="L75">        optionPanel.setLayout(boxLayout);</span>

<span class="nc" id="L77">        JPanel stringLengthOptionPanel = new JPanel();</span>
<span class="nc" id="L78">        JPanel md5OptionPanel = new JPanel();</span>
<span class="nc" id="L79">        JPanel sha1OptionPanel = new JPanel();</span>
<span class="nc" id="L80">        JPanel sha256OptionPanel = new JPanel();</span>
<span class="nc" id="L81">        JPanel sha384OptionPanel = new JPanel();</span>
<span class="nc" id="L82">        JPanel sha512OptionPanel = new JPanel();</span>
<span class="nc" id="L83">        JPanel crc32OptionPanel = new JPanel();</span>

<span class="nc" id="L85">        optionPanel.add(stringLengthOptionPanel);</span>
<span class="nc" id="L86">        optionPanel.add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L87">        optionPanel.add(md5OptionPanel);</span>
<span class="nc" id="L88">        optionPanel.add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L89">        optionPanel.add(sha1OptionPanel);</span>
<span class="nc" id="L90">        optionPanel.add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L91">        optionPanel.add(sha256OptionPanel);</span>
<span class="nc" id="L92">        optionPanel.add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L93">        optionPanel.add(sha384OptionPanel);</span>
<span class="nc" id="L94">        optionPanel.add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L95">        optionPanel.add(sha512OptionPanel);</span>
<span class="nc" id="L96">        optionPanel.add(Box.createVerticalStrut(Constants.DEFAULT_Y_BORDER));</span>
<span class="nc" id="L97">        optionPanel.add(crc32OptionPanel);</span>

<span class="nc" id="L99">        stringLengthOptionPanel.setLayout(new BoxLayout(stringLengthOptionPanel, BoxLayout.X_AXIS));</span>
<span class="nc" id="L100">        JLabel stringLengthLabel = new JLabel(&quot;String length:&quot;);</span>
<span class="nc" id="L101">        stringLengthTextField = new JTextField();</span>
<span class="nc" id="L102">        stringLengthOptionPanel.add(stringLengthLabel);</span>
<span class="nc" id="L103">        stringLengthOptionPanel.add(Box.createHorizontalStrut(Constants.DEFAULT_X_BORDER));</span>
<span class="nc" id="L104">        stringLengthOptionPanel.add(stringLengthTextField);</span>

<span class="nc" id="L106">        md5OptionPanel.setLayout(new BoxLayout(md5OptionPanel, BoxLayout.X_AXIS));</span>
<span class="nc" id="L107">        md5CheckBox = new JCheckBox(&quot;MD5 checksum:&quot;);</span>
<span class="nc" id="L108">        md5CheckBox.setSelected(true);</span>
<span class="nc" id="L109">        md5TextField = new JTextField();</span>
<span class="nc" id="L110">        md5OptionPanel.add(md5CheckBox);</span>
<span class="nc" id="L111">        md5OptionPanel.add(Box.createHorizontalStrut(Constants.DEFAULT_X_BORDER));</span>
<span class="nc" id="L112">        md5OptionPanel.add(md5TextField);</span>

<span class="nc" id="L114">        sha1OptionPanel.setLayout(new BoxLayout(sha1OptionPanel, BoxLayout.X_AXIS));</span>
<span class="nc" id="L115">        sha1CheckBox = new JCheckBox(&quot;SHA1 checksum:&quot;);</span>
<span class="nc" id="L116">        sha1TextField = new JTextField();</span>
<span class="nc" id="L117">        sha1OptionPanel.add(sha1CheckBox);</span>
<span class="nc" id="L118">        sha1OptionPanel.add(Box.createHorizontalStrut(Constants.DEFAULT_X_BORDER));</span>
<span class="nc" id="L119">        sha1OptionPanel.add(sha1TextField);</span>

<span class="nc" id="L121">        sha256OptionPanel.setLayout(new BoxLayout(sha256OptionPanel, BoxLayout.X_AXIS));</span>
<span class="nc" id="L122">        sha256CheckBox = new JCheckBox(&quot;SHA256 checksum:&quot;);</span>
<span class="nc" id="L123">        sha256TextField = new JTextField();</span>
<span class="nc" id="L124">        sha256OptionPanel.add(sha256CheckBox);</span>
<span class="nc" id="L125">        sha256OptionPanel.add(Box.createHorizontalStrut(Constants.DEFAULT_X_BORDER));</span>
<span class="nc" id="L126">        sha256OptionPanel.add(sha256TextField);</span>

<span class="nc" id="L128">        sha384OptionPanel.setLayout(new BoxLayout(sha384OptionPanel, BoxLayout.X_AXIS));</span>
<span class="nc" id="L129">        sha384CheckBox = new JCheckBox(&quot;SHA384 checksum:&quot;);</span>
<span class="nc" id="L130">        sha384TextField = new JTextField();</span>
<span class="nc" id="L131">        sha384OptionPanel.add(sha384CheckBox);</span>
<span class="nc" id="L132">        sha384OptionPanel.add(Box.createHorizontalStrut(Constants.DEFAULT_X_BORDER));</span>
<span class="nc" id="L133">        sha384OptionPanel.add(sha384TextField);</span>

<span class="nc" id="L135">        sha512OptionPanel.setLayout(new BoxLayout(sha512OptionPanel, BoxLayout.X_AXIS));</span>
<span class="nc" id="L136">        sha512CheckBox = new JCheckBox(&quot;SHA512 checksum:&quot;);</span>
<span class="nc" id="L137">        sha512TextField = new JTextField();</span>
<span class="nc" id="L138">        sha512OptionPanel.add(sha512CheckBox);</span>
<span class="nc" id="L139">        sha512OptionPanel.add(Box.createHorizontalStrut(Constants.DEFAULT_X_BORDER));</span>
<span class="nc" id="L140">        sha512OptionPanel.add(sha512TextField);</span>

<span class="nc" id="L142">        crc32OptionPanel.setLayout(new BoxLayout(crc32OptionPanel, BoxLayout.X_AXIS));</span>
<span class="nc" id="L143">        crc32CheckBox = new JCheckBox(&quot;CRC32 checksum:&quot;);</span>
<span class="nc" id="L144">        crc32TextField = new JTextField();</span>
<span class="nc" id="L145">        crc32OptionPanel.add(crc32CheckBox);</span>
<span class="nc" id="L146">        crc32OptionPanel.add(Box.createHorizontalStrut(Constants.DEFAULT_X_BORDER));</span>
<span class="nc" id="L147">        crc32OptionPanel.add(crc32TextField);</span>
<span class="nc" id="L148">    }</span>

    private void createOperationPanel() {
<span class="nc" id="L151">        operationPanel = new JPanel();</span>

<span class="nc" id="L153">        JButton compareButton = new JButton(&quot;Compare&quot;);</span>
<span class="nc" id="L154">        compareButton.setFocusPainted(false);</span>
<span class="nc" id="L155">        compareButton.addActionListener(arg0 -&gt; {</span>
<span class="nc" id="L156">            String text = stringInputTextArea.getText();</span>
<span class="nc bnc" id="L157" title="All 2 branches missed.">            if (text == null) {</span>
<span class="nc" id="L158">                logger.error(&quot;text is null&quot;);</span>
<span class="nc" id="L159">                return;</span>
            }
<span class="nc" id="L161">            calculate(text);</span>
<span class="nc" id="L162">        });</span>

<span class="nc" id="L164">        progressBar = new JProgressBar();</span>
<span class="nc" id="L165">        progressBar.setStringPainted(true);</span>
<span class="nc" id="L166">        progressBar.setMaximum(100);</span>


<span class="nc" id="L169">        operationPanel.setLayout(new BoxLayout(operationPanel, BoxLayout.X_AXIS));</span>
<span class="nc" id="L170">        operationPanel.add(compareButton);</span>
<span class="nc" id="L171">        operationPanel.add(Box.createHorizontalStrut(Constants.DEFAULT_X_BORDER));</span>
<span class="nc" id="L172">        operationPanel.add(progressBar);</span>

<span class="nc" id="L174">    }</span>

    private void calculate(String text) {
<span class="nc" id="L177">        progressBar.setValue(0);</span>
<span class="nc" id="L178">        new Thread(() -&gt; {</span>
<span class="nc" id="L179">            stringLengthTextField.setText(String.valueOf(text.length()));</span>
<span class="nc" id="L180">            progressBar.setValue(progressBar.getValue() + 10);</span>
<span class="nc" id="L181">        }).start();</span>

<span class="nc" id="L183">        new Thread(() -&gt; {</span>
<span class="nc bnc" id="L184" title="All 2 branches missed.">            if (md5CheckBox.isSelected()) {</span>
<span class="nc" id="L185">                md5TextField.setText(calculate(CalculateType.Md5, text));</span>
            } else {
<span class="nc" id="L187">                md5TextField.setText(&quot;&quot;);</span>
            }
<span class="nc" id="L189">            progressBar.setValue(progressBar.getValue() + 15);</span>
<span class="nc" id="L190">        }).start();</span>

<span class="nc" id="L192">        new Thread(() -&gt; {</span>
<span class="nc bnc" id="L193" title="All 2 branches missed.">            if (sha1CheckBox.isSelected()) {</span>
<span class="nc" id="L194">                sha1TextField.setText(calculate(CalculateType.Sha1, text));</span>
            } else {
<span class="nc" id="L196">                sha1TextField.setText(&quot;&quot;);</span>
            }
<span class="nc" id="L198">            progressBar.setValue(progressBar.getValue() + 15);</span>
<span class="nc" id="L199">        }).start();</span>

<span class="nc" id="L201">        new Thread(() -&gt; {</span>
<span class="nc bnc" id="L202" title="All 2 branches missed.">            if (sha256CheckBox.isSelected()) {</span>
<span class="nc" id="L203">                sha256TextField.setText(calculate(CalculateType.Sha256, text));</span>
            } else {
<span class="nc" id="L205">                sha256TextField.setText(&quot;&quot;);</span>
            }
<span class="nc" id="L207">            progressBar.setValue(progressBar.getValue() + 15);</span>
<span class="nc" id="L208">        }).start();</span>

<span class="nc" id="L210">        new Thread(() -&gt; {</span>
<span class="nc bnc" id="L211" title="All 2 branches missed.">            if (sha384CheckBox.isSelected()) {</span>
<span class="nc" id="L212">                sha384TextField.setText(calculate(CalculateType.Sha384, text));</span>
            } else {
<span class="nc" id="L214">                sha384TextField.setText(&quot;&quot;);</span>
            }
<span class="nc" id="L216">            progressBar.setValue(progressBar.getValue() + 15);</span>
<span class="nc" id="L217">        }).start();</span>

<span class="nc" id="L219">        new Thread(() -&gt; {</span>
<span class="nc bnc" id="L220" title="All 2 branches missed.">            if (sha512CheckBox.isSelected()) {</span>
<span class="nc" id="L221">                sha512TextField.setText(calculate(CalculateType.Sha512, text));</span>
            } else {
<span class="nc" id="L223">                sha512TextField.setText(&quot;&quot;);</span>
            }
<span class="nc" id="L225">            progressBar.setValue(progressBar.getValue() + 15);</span>
<span class="nc" id="L226">        }).start();</span>

<span class="nc" id="L228">        new Thread(() -&gt; {</span>
<span class="nc bnc" id="L229" title="All 2 branches missed.">            if (crc32CheckBox.isSelected()) {</span>
<span class="nc" id="L230">                crc32TextField.setText(calculate(CalculateType.Crc32, text));</span>
            } else {
<span class="nc" id="L232">                crc32TextField.setText(&quot;&quot;);</span>
            }
<span class="nc" id="L234">            progressBar.setValue(progressBar.getValue() + 15);</span>
<span class="nc" id="L235">        }).start();</span>
<span class="nc" id="L236">    }</span>

    private String calculate(final CalculateType selectedHash, final String text) {
<span class="nc" id="L239">        String result = &quot;&quot;;</span>
<span class="nc" id="L240">        try (ByteArrayInputStream bais = new ByteArrayInputStream(text.getBytes(StandardCharsets.UTF_8))) {</span>
<span class="nc bnc" id="L241" title="All 7 branches missed.">            switch (selectedHash) {</span>
                case Md5: {
<span class="nc" id="L243">                    result = DigestUtils.md5Hex(bais);</span>
<span class="nc" id="L244">                    break;</span>
                }
                case Sha1: {
<span class="nc" id="L247">                    result = DigestUtils.sha1Hex(bais);</span>
<span class="nc" id="L248">                    break;</span>
                }
                case Sha256: {
<span class="nc" id="L251">                    result = DigestUtils.sha256Hex(bais);</span>
<span class="nc" id="L252">                    break;</span>
                }
                case Sha384: {
<span class="nc" id="L255">                    result = DigestUtils.sha384Hex(bais);</span>
<span class="nc" id="L256">                    break;</span>
                }
                case Sha512: {
<span class="nc" id="L259">                    result = DigestUtils.sha512Hex(bais);</span>
<span class="nc" id="L260">                    break;</span>
                }
                case Crc32: {
<span class="nc" id="L263">                    CRC32 crc32 = new CRC32();</span>
<span class="nc" id="L264">                    crc32.update(text.getBytes());</span>
<span class="nc" id="L265">                    result = Long.toHexString(crc32.getValue());</span>
<span class="nc" id="L266">                    break;</span>
                }
                default: {
<span class="nc" id="L269">                    result = &quot;Not support&quot;;</span>
                    break;
                }
            }
<span class="nc" id="L273">        } catch (IOException e) {</span>
<span class="nc" id="L274">            logger.error(&quot;calculate, IOException&quot;);</span>
<span class="nc" id="L275">        }</span>
<span class="nc" id="L276">        return result;</span>
    }
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.14.202510111229</span></div></body></html>